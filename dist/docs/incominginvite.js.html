<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: incominginvite.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: incominginvite.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>&apos;use strict&apos;;

var EventEmitter = require(&apos;events&apos;).EventEmitter;
var inherits = require(&apos;util&apos;).inherits;

/**
 * Construct an {@link IncomingInvite}.
 * @class
 * @classdesc An {@link IncomingInvite} to a {@link Conversation} can be
 * accepted or rejected.
 * &lt;br&gt;&lt;br&gt;
 * {@link IncomingInvite}s are returned by {@link Client#event:invite}.
 * @param {IncomingInviteSignaling} signaling
 * @param {function(IncomingInvite.AcceptOptions, function(LocalMedia): Promise&lt;ConversationSignaling&gt;): Promise&lt;ConversationSignaling&gt;} getLocalMedia
 * @param {function(IncomingInvite.AcceptOptions, ConversationSignaling): Conversation} createConversation
 * @property {Conversation.SID} conversationSid - the SID of the {@link Conversation} this {@link IncomingInvite} invites to
 * @property {?string} from - the identity of the {@link Participant} that send this {@link IncomingInvite}
 * @property {Array&lt;sting&gt;} participants - the identities of the {@link Participant}s currently in the {@link Conversation}
 * @property {status} - the status of this {@link IncomingInvite}; one of &quot;pending&quot;, &quot;accepting&quot;, &quot;accepted&quot;, &quot;rejected&quot;,
 * &quot;canceled&quot;, or &quot;failed&quot;
 * @fires IncomingInvite#accepted
 * @fires IncomingInvite#accepting
 * @fires IncomingInvite#canceled
 * @fires IncomingInvite#failed
 * @fires IncomingInvite#pending
 * @fires IncomingInvite#rejected
 */
function IncomingInvite(signaling, getLocalMedia, createConversation, options) {
  if (!(this instanceof IncomingInvite)) {
    return new IncomingInvite(signaling, getLocalMedia, createConversation);
  }
  EventEmitter.call(this);
  options = Object.assign({}, options);
  Object.defineProperties(this, {
    _createConversation: {
      value: createConversation
    },
    _getLocalMedia: {
      value: getLocalMedia
    },
    _options: {
      value: options
    },
    _signaling: {
      value: signaling
    },
    conversationSid: {
      enumerable: true,
      value: signaling.conversationSid
    },
    from: {
      enumerable: true,
      value: signaling.from
    },
    participants: {
      enumerable: true,
      value: signaling.from ? [signaling.from] : []
    },
    participantSid: {
      enumerable: true,
      value: signaling.participantSid
    },
    status: {
      enumerable: true,
      get: function() {
        return signaling.state;
      }
    }
  });

  handleSignalingEvents(this, signaling);
}

inherits(IncomingInvite, EventEmitter);

/**
 * Accept the {@link IncomingInvite} and join the {@link Conversation}.
 * @param {IncomingInvite.AcceptOptions} [options={localStreamConstraints:{audio:true,video:true}}] - Options to override {@link IncomingInvite#accept}&apos;s default behavior
 * @returns {Promise&lt;Conversation&gt;}
 * @example
 * var initialToken = getAccessToken();
 * var client = new Twilio.Conversations.Client(initialToken);
 *
 * client.on(&apos;invite&apos;, function(invite) {
 *   console.log(&apos;Received IncomingInvite to join a Conversation with &apos; + invite.from);
 *
 *   // By default, accept will request the microphone and camera for you.
 *   invite.accept();
 * });
 */
IncomingInvite.prototype.accept = function accept(options) {
  options = Object.assign({}, this._options, options);
  var self = this;
  return this._getLocalMedia(options, function getLocalMediaSucceeded(localMedia) {
    return self._signaling.accept(localMedia, options);
  }).then(function acceptSucceeded(conversationSignaling) {
    return self._createConversation(options, conversationSignaling);
  });
};

/**
 * Reject the {@link IncomingInvite} to a {@link Conversation}.
 * @returns {this}
 * @example
 * var initialToken = getAccessToken();
 * var client = new Twilio.Conversations.Client(initialToken);
 *
 * client.on(&apos;invite&apos;, function(invite) {
 *   console.log(&apos;Rejecting IncomingInvite to join a Conversation with &apos; + invite.from);
 *   invite.reject();
 * });
 */
IncomingInvite.prototype.reject = function reject() {
  this._signaling.reject();
  return this;
};

/**
 * The {@link IncomingInvite} was accepted, and the {@link Client} is now
 * participating in the {@link Conversation}.
 * @param {IncomingInvite} invite - The {@link IncomingInvite}
 * @event IncomingInvite#accepted
 */

/**
 * The {@link Client} is attempting to accept the {@link IncomingInvite}.
 * @param {IncomingInvite} invite - The {@link IncomingInvite}
 * @event IncomingInvite#accepting
 */

/**
 * The {@link IncomingInvite} was canceled.
 * @param {IncomingInvite} invite - The {@link IncomingInvite}
 * @event IncomingInvite#canceled
 */

/**
 * The {@link IncomingInvite} failed.
 * @param {IncomingInvite} invite - The {@link IncomingInvite}
 * @event IncomingInvite#failed
 */

/**
 * The {@link IncomingInvite} is pending.
 * @param {IncomingInvite} invite - The {@link IncomingInvite}
 * @event IncomingInvite#pending
 */

/**
 * The {@link IncomingInvite} was rejected.
 * @param {IncomingInvite} invite - The {@link IncomingInvite}
 * @event IncomingInvite#rejected
 */

/**
 * You may pass these options to {@link IncomingInvite#accept} to
 * override the default behavior.
 * @typedef {object} IncomingInvite.AcceptOptions
 * @property {Array&lt;RTCIceServer&gt;} iceServers - Override the STUN and TURN
 * servers used by the {@link Client} when connecting to {@link Conversation}s
 * @property {RTCIceTransportPolicy} [iceTransportPolicy=&quot;all&quot;] - Override the
 * ICE transport policy to be one of &quot;relay&quot; or &quot;all&quot;
 * @property {?LocalMedia} [localMedia=null] - Set to reuse an existing
 * {@link LocalMedia} object when accepting an {@link IncomingInvite}
 * @property {?MediaStream} [localStream=null] - Set to reuse an existing
 * MediaStream when accepting an {@link IncomingInvite}
 * @property {?object} [localStreamConstraints={audio:true,video:true}] - Set to
 * override the parameters passed to &lt;code&gt;getUserMedia&lt;/code&gt; when neither
 * &lt;code&gt;localMedia&lt;/code&gt; nor &lt;code&gt;localStream&lt;/code&gt; are provided
 */

function handleSignalingEvents(incomingInvite, signaling) {
  // Reemit state transition events from the IncomingInviteSignaling.
  signaling.on(&apos;stateChanged&apos;, function stateChanged(state) {
    incomingInvite.emit(state, incomingInvite);
  });
}

module.exports = IncomingInvite;
</code></pre>
        </article>
    </section>




</div>

<nav><h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Client.html"><span style="color: #999">Twilio.Conversations.</span>Client</a><ul style="margin-left: 1em"><li><a href="IncomingInvite.html">IncomingInvite</a></li><li><a href="OutgoingInvite.html">OutgoingInvite</a></li></ul></li><li><a href="Conversation.html">Conversation</a><ul style="margin-left: 1em"><li><a href="Participant.html">Participant</a></li></ul></li><li><a href="Media.html">Media</a><ul style="margin-left: 1em"><li><a href="LocalMedia.html"><span style="color: #999">Twilio.Conversations.</span>LocalMedia</a></li><li><a href="LocalTrack.html">LocalTrack</a></li><li><a href="Track.html">Track</a><ul style="margin-left: 1em"><li><a href="AudioTrack.html">AudioTrack</a><ul style="margin-left: 1em"><li><a href="LocalAudioTrack.html">LocalAudioTrack</a></li></ul></li><li><a href="VideoTrack.html">VideoTrack</a><ul style="margin-left: 1em"><li><a href="LocalVideoTrack.html">LocalVideoTrack</a></li></ul></li></ul></li></ul></li></ul></nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0-dev</a> on Wed Jun 15 2016 21:47:42 GMT+0000 (UTC)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create', 'UA-2900316-33', 'auto');ga('send', 'pageview');</script></body>
</html>
